# FindlyAPI

# API Documentation: `/api/search`

Этот API предоставляет функциональность для поиска продуктов на различных онлайн-рынках с возможностью фильтрации и настройки параметров запроса.

## Основной эндпоинт: `/api/search`

### Метод: `GET`

### Описание:
Этот эндпоинт выполняет поиск продуктов на нескольких онлайн-рынках с учетом различных фильтров и параметров. Возвращает JSON-ответ с результатами поиска, включая метаданные запроса.

---

## Параметры запроса

| Параметр                  | Тип данных       | Описание                                                                                                                                           | Возможные значения                                                | Обязателен? |
|---------------------------|------------------|---------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------|-------------|
| `q`                        | `string`         | Запрос для поиска продуктов. Это основной параметр, который определяет, что искать.                                                              | Строка с запросом (например, "iPhone 13")                        | Да          |
| `ms`                       | `int`            | Максимальное количество продуктов для возврата. Указывает максимальное количество товаров, которое будет возвращено.                              | Целое число от 1 до 40                                           | Нет         |
| `on`                       | `string`         | Фильтр для показа только новых продуктов. Если включено, возвращаются только новые товары.                                                        | `on`, `off` (по умолчанию `on`, если не указано)                  | Нет         |
| `epf`                      | `string`         | Фильтр для включения фильтрации по цене. Если указано, будет применена фильтрация продуктов по цене.                                               | `on`, `off` (по умолчанию `on`, если не указано)                  | Нет         |
| `enf`                      | `string`         | Фильтр для включения фильтрации по имени. Если указано, будет применена фильтрация по имени продукта.                                               | `on`, `off` (по умолчанию `on`, если не указано)                  | Нет         |
| `ew`                       | `string`         | Слово (или слова), которые необходимо исключить из результатов поиска. Если указан этот параметр, API исключит все товары, содержащие это слово. | Строка (например, "refurbished")                                  | Нет         |

---

## Пример запроса

### Пример 1: Поиск продуктов по запросу "iPhone 13" с максимальным количеством 10 продуктов.

GET /api/search?q=iPhone+13&ms=10


### Пример 2: Поиск новых продуктов "iPhone 13" с фильтрацией по цене.

GET /api/search?q=iPhone+13&on=on&epf=on


### Пример 3: Поиск продуктов "iPhone 13", исключая слово "refurbished".

GET /api/search?q=iPhone+13&ew=refurbished


---

## Ответ

### Успешный ответ (код 200)

Ответ включает два объекта: `products_data` (данные о продуктах) и `request_metadata` (метаданные запроса).

Пример ответа:

```json
{
  "products_data": {
    "MMG": [...],
    "Onliner": [...],
    "Kufar": [...],
    "21vek": [...]
  },
  "request_metadata": {
    "date": "12-17-2024 12:34:56",
    "response_time": 0.123,
    "size_of_products": {
      "all": 150,
      "mmg": 50,
      "onliner": 40,
      "kufar": 30,
      "21vek": 30
    },
    "request_args": {
      "max_size": 10,
      "only_new": true,
      "query": "iPhone 13",
      "enable_filter_by_price": true,
      "enable_filter_by_name": true,
      "exclusion_word": "refurbished"
    },
    "request_url": "http://localhost:5000/api/search?q=iPhone+13&ms=10"
  }
}
```
Ошибки

    404: Не найден ресурс.
    405: Метод не поддерживается для этого ресурса.
    403: Доступ запрещен.
    422: Некорректные параметры запроса.

Описание логики параметров
Параметр q (Запрос для поиска)

    Тип: string
    Описание: Основной параметр, определяющий, что именно вы ищете. Например, запрос может быть названием продукта, брендом или категорией.

Параметр ms (Максимальный размер)

    Тип: int
    Описание: Ограничивает количество возвращаемых продуктов. Число должно быть от 1 до 40. Если параметр не указан, возвращаются все доступные результаты по запросу.

Параметр on (Только новые товары)

    Тип: string
    Описание: Если установлено в on, будут возвращены только новые товары. Если установлено в off или не указано, будут возвращены все товары.

Параметр epf (Фильтрация по цене)

    Тип: string
    Описание: Включает или отключает фильтрацию продуктов по цене. Если установлено в on, фильтрация по цене будет активна. Если в off или не указано, фильтрация по цене не применяется.

Параметр enf (Фильтрация по имени)

    Тип: string
    Описание: Включает или отключает фильтрацию продуктов по имени. Если установлено в on, будет применяться фильтрация по имени продукта.

Параметр ew (Исключаемое слово)

    Тип: string
    Описание: Исключает продукты, которые содержат указанное слово. Например, если указать слово "refurbished", все продукты, содержащие это слово, будут исключены из результатов поиска.

Ошибки
422 - Unprocessable Entity

    Возникает, если запрос содержит некорректные или несовместимые параметры.
    Пример: если переданы несовместимые параметры, такие как включенная фильтрация по имени и одновременно исключающее слово, которое присутствует в запросе.

403 - Forbidden

    Возникает, если IP-адрес клиента заблокирован или нет доступа к API.

Логирование

Все запросы и ошибки записываются в лог-файл, где можно отслеживать важные события и ошибки работы API.
Примечание:

    API использует CORS, что позволяет работать с запросами из разных доменов (например, для фронтенда, хостящегося на другом домене).
    При возникновении ошибок пользователю будет возвращена подробная информация о ошибке в формате JSON с кодом ошибки и описанием.
