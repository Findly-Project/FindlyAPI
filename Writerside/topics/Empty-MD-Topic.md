# FindlyAPI

## API Documentation: `/api/search`

Этот API предоставляет функциональность для поиска товаров на различных маркетплейсах с возможностью фильтрации и настройки параметров запроса.

### Основной эндпоинт: `/api/search`
### Метод: `GET`
### Описание:
Этот эндпоинт выполняет поиск продуктов на нескольких маркетплейсах с учетом различных фильтров и параметров. Возвращает JSON-ответ с результатами поиска, включая метаданные запроса.

---

### Параметры запроса

| Параметр | Тип данных | Описание                                                                                                                                         | Возможные значения                               | Обязателен? |
|----------|------------|--------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------|-------------|
| `q`      | `string`   | Запрос для поиска продуктов. Это основной параметр, который определяет, что искать.                                                              | Строка с запросом (например, "iPhone 13")        | Да          |
| `ms`     | `int`      | Максимальное количество продуктов для возврата. Указывает максимальное количество товаров, которое будет возвращено.                             | Целое число от `1` до `40`                       | Нет         |
| `on`     | `string`   | Фильтр для показа только новых продуктов. Если включено, возвращаются только новые товары.                                                       | `on`, `off` (по умолчанию `on`, если не указано) | Нет         |
| `epf`    | `string`   | Фильтр для включения фильтрации по цене. Если указано, будет применена фильтрация продуктов по цене.                                             | `on`, `off` (по умолчанию `on`, если не указано) | Нет         |
| `enf`    | `string`   | Фильтр для включения фильтрации по имени. Если указано, будет применена фильтрация по имени продукта.                                            | `on`, `off` (по умолчанию `on`, если не указано) | Нет         |
| `ew`     | `string`   | Слово (или слова), которые необходимо исключить из результатов поиска. Если указан этот параметр, API исключит все товары, содержащие это слово. | Строка (например, "refurbished")                 | Нет         |

---

### Примеры запроса

##### Поиск продуктов по запросу "iPhone 13" с максимальным количеством 10 продуктов.

```http
GET /api/search?q=iPhone+13&ms=10
```

##### Поиск только новых товаров "iPhone 13" с фильтрацией по цене.

```http
GET /api/search?q=iPhone+13&on=on&epf=on
```

##### Поиск продуктов "iPhone 13", исключая слово "refurbished".

```http
GET /api/search?q=iPhone+13&ew=refurbished
```


---

## Примеры тела ответа

### Успешный ответ (код 200)

Ответ включает два объекта: `products_data` (данные о продуктах) и `request_metadata` (метаданные запроса).

Пример ответа:

```json
{
  "products_data": {
    "MMG": [...],
    "Onliner": [...],
    "Kufar": [...],
    "21vek": [...]
  },
  "request_metadata": {
    "date": "12-17-2024 12:34:56",
    "response_time": 0.123,
    "size_of_products": {
      "all": 150,
      "mmg": 50,
      "onliner": 40,
      "kufar": 30,
      "21vek": 30
    },
    "request_args": {
      "max_size": 10,
      "only_new": true,
      "query": "iPhone 13",
      "enable_filter_by_price": true,
      "enable_filter_by_name": true,
      "exclusion_word": "refurbished"
    },
    "request_url": "http://localhost:5000/api/search?q=iPhone+13&ms=10",
    "response_code": 200
  }
}
```

Пример тела товара:
```json
{
  "image": "https://rms.kufar.by/v1/",
  "link": "https://www.kufar.by/item/",
  "name": "xiaomi 13 lite 256gb",
  "price": 390.0
}
```

### Неуспешный ответ (код, к примеру, 422)

```json
{
  "default_error": "422 Unprocessable Entity: The request was well-formed but was unable to be followed due to semantic errors.",
  "pretty_error": "Incorrect request parameters, read the API documentation https://github.com/koloideal/FindlyAPI/blob/main/README.md",
  "request_metadata": {
    "date": "12-17-2024 22:09:58",
    "request_url": "http://127.0.0.1:5000/api/search?epf=on&on=off&ew=air",
    "response_code": 422
  }
}
```

## Возможные ошибки ответа

| **Ошибка** | **Описание**                                   |
|------------|------------------------------------------------|
| **405**    | **Метод не поддерживается для этого ресурса**  |
| **404**    | **Не найден ресурс**                           |
| **403**    | **Доступ запрещен**                            |
| **422**    | **Некорректные параметры запроса**             |
